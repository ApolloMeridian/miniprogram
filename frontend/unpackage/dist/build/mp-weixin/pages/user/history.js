(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/user/history"],{"1a54":function(t,e,n){"use strict";n.d(e,"b",(function(){return u})),n.d(e,"c",(function(){return r})),n.d(e,"a",(function(){return o}));var o={uEmpty:function(){return n.e("node-modules/uview-ui/components/u-empty/u-empty").then(n.bind(null,"aba2"))},uTag:function(){return n.e("node-modules/uview-ui/components/u-tag/u-tag").then(n.bind(null,"ccda"))},uIcon:function(){return n.e("node-modules/uview-ui/components/u-icon/u-icon").then(n.bind(null,"1e2a"))},unicloudDb:function(){return Promise.all([n.e("common/vendor"),n.e("node-modules/@dcloudio/uni-cli-shared/components/unicloud-db")]).then(n.bind(null,"960d"))},uLoading:function(){return n.e("node-modules/uview-ui/components/u-loading/u-loading").then(n.bind(null,"de07"))},uCellGroup:function(){return n.e("node-modules/uview-ui/components/u-cell-group/u-cell-group").then(n.bind(null,"fa18"))},uCellItem:function(){return n.e("node-modules/uview-ui/components/u-cell-item/u-cell-item").then(n.bind(null,"2fd3"))},uniDateformat:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uni-dateformat/components/uni-dateformat/uni-dateformat")]).then(n.bind(null,"e8d5"))},uButton:function(){return n.e("node-modules/uview-ui/components/u-button/u-button").then(n.bind(null,"f9a8"))}},u=function(){var t=this,e=t.$createElement,n=(t._self._c,0!=t.trip.length?t.__map(t.trip,(function(e,n){var o=t.__get_orig(e),u=t.$u.date(e.start_time,"hh:MM:ss"),r=t.$u.date(e.end_time,"hh:MM:ss"),i=t.$u.date(e.start_time,"yyyy年mm月dd日");return{$orig:o,g0:u,g1:r,g2:i}})):null);t.$mp.data=Object.assign({},{$root:{l0:n}})},r=[]},"52aa":function(t,e,n){"use strict";var o=n("b728"),u=n.n(o);u.a},"6f4c":function(t,e,n){"use strict";(function(t){n("8342");o(n("66fd"));var e=o(n("facc"));function o(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},b728:function(t,e,n){},d2e2:function(t,e,n){"use strict";n.r(e);var o=n("ed04"),u=n.n(o);for(var r in o)"default"!==r&&function(t){n.d(e,t,(function(){return o[t]}))}(r);e["default"]=u.a},ed04:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=r(n("a34a")),u=n("2f62");function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e,n,o,u,r,i){try{var c=t[r](i),a=c.value}catch(s){return void n(s)}c.done?e(a):Promise.resolve(a).then(o,u)}function c(t){return function(){var e=this,n=arguments;return new Promise((function(o,u){var r=t.apply(e,n);function c(t){i(r,o,u,c,a,"next",t)}function a(t){i(r,o,u,c,a,"throw",t)}c(void 0)}))}}function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var d={data:function(){return{tagType:{"待记录":"warning","待提交":"primary","已提交":"success"}}},computed:s(s({},(0,u.mapState)(["trip"])),{},{canUpload:function(){return this.trip.some((function(t){return"待提交"==t.status}))}}),onShow:function(){this.setBadge()},onReady:function(){this.$refs.udb.loadData(),this.setBadge()},onPullDownRefresh:function(){this.$refs.udb.loadData({clear:!0},(function(){t.stopPullDownRefresh()}))},methods:{setBadge:function(){this.trip.some((function(t){return"待记录"==t.status||"待提交"==t.status}))?t.showTabBarRedDot({index:1}):t.hideTabBarRedDot({index:1})},editTrip:function(t){this.$u.route("/pages/trip/edit",{index:t})},removeTrip:function(e){var n=this;t.showModal({title:"确定删除本条记录？",confirmColor:"#FA3534",success:function(t){t.confirm&&(console.log("remove trip index: ",e),n.$store.commit("removeTrip",e),n.$u.toast("删除成功"))}}),this.setBadge()},listItemClick:function(t){console.log("cloud record click: ",t),this.$u.toast("云端记录查看功能暂未开放")},upload:function(){var e=this;return c(o.default.mark((function n(){var u,r,i;return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.showLoading({title:"正在上传"}),u=[],e.trip.forEach((function(t){"待提交"==t.status&&u.push(t)})),n.prev=3,n.next=6,e.$db.collection("tx-trip").add(u);case 6:r=n.sent,t.hideLoading(),e.$u.toast("成功上传".concat(r.result.inserted,"条数据")),u.forEach((function(t){return t.status="已提交"})),i=[],e.trip.forEach((function(t){"已提交"!=t.status&&i.push(t)})),e.$store.commit("resetTrip",i),e.$refs.udb.loadData({clear:!0}),e.setBadge(),n.next=21;break;case 17:n.prev=17,n.t0=n["catch"](3),t.hideLoading(),t.showModal({title:"上传数据失败",content:JSON.stringify(n.t0,null,2),showCancel:!1,confirmText:"复制报错信息",success:function(){t.setClipboardData({data:JSON.stringify(n.t0,null,2)})}});case 21:case"end":return n.stop()}}),n,null,[[3,17]])})))()}}};e.default=d}).call(this,n("543d")["default"])},facc:function(t,e,n){"use strict";n.r(e);var o=n("1a54"),u=n("d2e2");for(var r in u)"default"!==r&&function(t){n.d(e,t,(function(){return u[t]}))}(r);n("52aa");var i,c=n("f0c5"),a=Object(c["a"])(u["default"],o["b"],o["c"],!1,null,"555bee30",null,!1,o["a"],i);e["default"]=a.exports}},[["6f4c","common/runtime","common/vendor"]]]);